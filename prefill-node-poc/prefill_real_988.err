2026-01-30 13:33:08.691 | DEBUG    | ttnn:<module>:77 - Initial ttnn.CONFIG:
Config{cache_path=/home/dmadic/.cache/ttnn,model_cache_path=/home/dmadic/.cache/ttnn/models,tmp_dir=/tmp/ttnn,enable_model_cache=false,enable_fast_runtime_mode=true,throw_exception_on_fallback=false,enable_logging=false,enable_graph_report=false,enable_detailed_buffer_report=false,enable_detailed_tensor_report=false,enable_comparison_mode=false,comparison_mode_should_raise_exception=false,comparison_mode_pcc=0.9999,root_report_path=generated/ttnn/reports,report_name=std::nullopt,std::nullopt}
2026-01-30 13:33:10.846 | INFO     | ttnn.distributed.ttrun:print_command:231 - [tt-run] Command:
2026-01-30 13:33:10.846 | INFO     | ttnn.distributed.ttrun:print_command:245 - [tt-run] Command: mpirun --hostfile /tmp/988_hosts.txt --map-by ppr:1:node --mca btl self,tcp --mca btl_tcp_if_exclude docker0,lo --bind-to none --tag-output -np 1 -x TT_METAL_CACHE=/home/dmadic/.cache_wh-glx-a05u02_rank0 -x TT_MESH_ID=0 -x TT_MESH_GRAPH_DESC_PATH=/data/dmadic/tt-metal/tt_metal/fabric/mesh_graph_descriptors/dual_galaxy_mesh_graph_descriptor.textproto -x TT_METAL_HOME=/data/dmadic/tt-metal -x TT_METAL_RUNTIME_ROOT=/data/dmadic/tt-metal -x PYTHONPATH=/data/dmadic/tt-metal:/data/dmadic/tt-inference-server/prefill-node-poc: -x LD_LIBRARY_PATH=/home/dmadic/build/lib -x TT_MESH_HOST_RANK=0 python /data/dmadic/tt-inference-server/prefill-node-poc/main_prefill_real.py --model-path /mnt/models/deepseek-ai/DeepSeek-R1-0528 --cache-dir /data/dmadic/deepseek-ai/DeepSeek-R1-0528-Cache What is the capital of France? : -np 1 -x TT_METAL_CACHE=/home/dmadic/.cache_wh-glx-a05u02_rank1 -x TT_MESH_ID=0 -x TT_MESH_GRAPH_DESC_PATH=/data/dmadic/tt-metal/tt_metal/fabric/mesh_graph_descriptors/dual_galaxy_mesh_graph_descriptor.textproto -x TT_METAL_HOME=/data/dmadic/tt-metal -x TT_METAL_RUNTIME_ROOT=/data/dmadic/tt-metal -x PYTHONPATH=/data/dmadic/tt-metal:/data/dmadic/tt-inference-server/prefill-node-poc: -x LD_LIBRARY_PATH=/home/dmadic/build/lib -x TT_MESH_HOST_RANK=1 python /data/dmadic/tt-inference-server/prefill-node-poc/main_prefill_real.py --model-path /mnt/models/deepseek-ai/DeepSeek-R1-0528 --cache-dir /data/dmadic/deepseek-ai/DeepSeek-R1-0528-Cache What is the capital of France?
[1,0]<stderr>: 2026-01-30 13:33:13.401 | DEBUG    | ttnn:<module>:77 - Initial ttnn.CONFIG:
[1,0]<stderr>: Config{cache_path=/home/dmadic/.cache/ttnn,model_cache_path=/home/dmadic/.cache/ttnn/models,tmp_dir=/tmp/ttnn,enable_model_cache=false,enable_fast_runtime_mode=true,throw_exception_on_fallback=false,enable_logging=false,enable_graph_report=false,enable_detailed_buffer_report=false,enable_detailed_tensor_report=false,enable_comparison_mode=false,comparison_mode_should_raise_exception=false,comparison_mode_pcc=0.9999,root_report_path=generated/ttnn/reports,report_name=std::nullopt,std::nullopt}
[1,1]<stderr>: 2026-01-30 13:33:15.057 | DEBUG    | ttnn:<module>:77 - Initial ttnn.CONFIG:
[1,1]<stderr>: Config{cache_path=/home/dmadic/.cache/ttnn,model_cache_path=/home/dmadic/.cache/ttnn/models,tmp_dir=/tmp/ttnn,enable_model_cache=false,enable_fast_runtime_mode=true,throw_exception_on_fallback=false,enable_logging=false,enable_graph_report=false,enable_detailed_buffer_report=false,enable_detailed_tensor_report=false,enable_comparison_mode=false,comparison_mode_should_raise_exception=false,comparison_mode_pcc=0.9999,root_report_path=generated/ttnn/reports,report_name=std::nullopt,std::nullopt}
[1,0]<stderr>: root: Selected MESH_DEVICE: 'DUAL' - mesh shape: MeshShape([8, 8])
[1,0]<stderr>: root: Setting fabric config to FabricConfig.FABRIC_1D
[1,1]<stderr>: root: Selected MESH_DEVICE: 'DUAL' - mesh shape: MeshShape([8, 8])
[1,1]<stderr>: root: Setting fabric config to FabricConfig.FABRIC_1D
[1,0]<stderr>: root: Opening mesh device with shape MeshShape([8, 8])
[1,1]<stderr>: root: Opening mesh device with shape MeshShape([8, 8])
[1,1]<stderr>: 2026-01-30 13:33:20.547 | DEBUG    | ttnn.device:__init__:150 - Using default dispatch core type for this system: DispatchCoreType.WORKER
[1,1]<stderr>: 2026-01-30 13:33:20.547 | DEBUG    | ttnn.device:__init__:152 - Using default dispatch core axis for this system: DispatchCoreAxis.ROW
[1,0]<stderr>: 2026-01-30 13:33:20.547 | DEBUG    | ttnn.device:__init__:150 - Using default dispatch core type for this system: DispatchCoreType.WORKER
[1,0]<stderr>: 2026-01-30 13:33:20.547 | DEBUG    | ttnn.device:__init__:152 - Using default dispatch core axis for this system: DispatchCoreAxis.ROW
[1,1]<stderr>: root: Creating PrefillEngine...
[1,1]<stderr>: scheduler: kv_cache memory calc available_gb=12.00 num_layers=61 -> num_blocks=11459
[1,1]<stderr>: scheduler: block_manager num_blocks=11459 (from memory calc)
[1,1]<stderr>: 2026-01-30 13:33:31.448 | WARNING  | models.perf.benchmarking_utils:<module>:18 - Skipping import of pydantic_models for benchmarking since not running in CI environment
[1,1]<stderr>: model_runner: Loading tokenizer from /mnt/models/deepseek-ai/DeepSeek-R1-0528
[1,1]<stderr>: model_runner: Initializing DeepseekGenerator...
[1,0]<stderr>: root: Creating PrefillEngine...
[1,0]<stderr>: scheduler: kv_cache memory calc available_gb=12.00 num_layers=61 -> num_blocks=11459
[1,0]<stderr>: scheduler: block_manager num_blocks=11459 (from memory calc)
[1,0]<stderr>: 2026-01-30 13:33:36.386 | WARNING  | models.perf.benchmarking_utils:<module>:18 - Skipping import of pydantic_models for benchmarking since not running in CI environment
[1,0]<stderr>: model_runner: Loading tokenizer from /mnt/models/deepseek-ai/DeepSeek-R1-0528
[1,0]<stderr>: model_runner: Initializing DeepseekGenerator...
[1,0]<stderr>: 2026-01-30 13:33:36.703 | INFO     | models.demos.deepseek_v3.tt.generator:__init__:144 - Enable trace: False
[1,1]<stderr>: 2026-01-30 13:33:36.703 | INFO     | models.demos.deepseek_v3.tt.generator:__init__:144 - Enable trace: False
[1,0]<stderr>: 2026-01-30 13:33:36.951 | INFO     | models.demos.deepseek_v3.utils.weight_config:_try_load_cached_config:104 - Using weights cached at /data/dmadic/deepseek-ai/DeepSeek-R1-0528-Cache/61_layers/mesh_8x8
[1,1]<stderr>: 2026-01-30 13:33:36.951 | INFO     | models.demos.deepseek_v3.utils.weight_config:_try_load_cached_config:104 - Using weights cached at /data/dmadic/deepseek-ai/DeepSeek-R1-0528-Cache/61_layers/mesh_8x8
[1,0]<stderr>: model_runner: Preparing prefill run config...
[1,1]<stderr>: model_runner: Preparing prefill run config...
[1,1]<stderr>: 2026-01-30 13:33:36.957 | INFO     | models.demos.deepseek_v3.tt.generator:_prepare_run_configs:202 - Creating model prefill config...
[1,0]<stderr>: 2026-01-30 13:33:36.957 | INFO     | models.demos.deepseek_v3.tt.generator:_prepare_run_configs:202 - Creating model prefill config...
[1,0]<stderr>: 2026-01-30 13:33:36.957 | INFO     | models.demos.deepseek_v3.tt.generator:_prepare_model_states:187 - Creating model states...
[1,1]<stderr>: 2026-01-30 13:33:36.957 | INFO     | models.demos.deepseek_v3.tt.generator:_prepare_model_states:187 - Creating model states...
[1,1]<stderr>: Creating MLP layer states:   0%|          | 0/3 [00:00<?, ?it/s]Creating MLP layer states:   0%|          | 0/3 [00:00<?, ?it/s]Creating MLP layer states:  33%|███▎      | 1/3 [00:00<00:00,  4.26it/s]Creating MLP layer states:  33%|███▎      | 1/3 [00:00<00:00,  4.27it/s]Creating MLP layer states:  67%|██████▋   | 2/3 [00:00<00:00,  4.28it/s]Creating MLP layer states:  67%|██████▋   | 2/3 [00:00<00:00,  4.25it/s]Creating MLP layer states: 100%|██████████| 3/3 [00:00<00:00,  4.34it/s]Creating MLP layer states: 100%|██████████| 3/3 [00:00<00:00,  4.32it/s]
[1,0]<stderr>: Creating MoE layer states:   0%|          | 0/58 [00:00<?, ?it/s]Creating MLP layer states: 100%|██████████| 3/3 [00:00<00:00,  4.29it/s]Creating MLP layer states: 100%|██████████| 3/3 [00:00<00:00,  4.28it/s]
[1,1]<stderr>: Creating MoE layer states:   0%|          | 0/58 [00:00<?, ?it/s]Creating MoE layer states:   2%|▏         | 1/58 [00:00<00:12,  4.40it/s]Creating MoE layer states:   2%|▏         | 1/58 [00:00<00:13,  4.28it/s]Creating MoE layer states:   3%|▎         | 2/58 [00:00<00:12,  4.37it/s]Creating MoE layer states:   3%|▎         | 2/58 [00:00<00:13,  4.29it/s]Creating MoE layer states:   5%|▌         | 3/58 [00:00<00:12,  4.38it/s]Creating MoE layer states:   5%|▌         | 3/58 [00:00<00:12,  4.30it/s]Creating MoE layer states:   7%|▋         | 4/58 [00:00<00:12,  4.38it/s]Creating MoE layer states:   7%|▋         | 4/58 [00:00<00:12,  4.27it/s]Creating MoE layer states:   9%|▊         | 5/58 [00:01<00:12,  4.37it/s]Creating MoE layer states:   9%|▊         | 5/58 [00:01<00:12,  4.30it/s]Creating MoE layer states:  10%|█         | 6/58 [00:01<00:11,  4.37it/s]Creating MoE layer states:  10%|█         | 6/58 [00:01<00:12,  4.31it/s]Creating MoE layer states:  12%|█▏        | 7/58 [00:01<00:11,  4.37it/s]Creating MoE layer states:  12%|█▏        | 7/58 [00:01<00:11,  4.32it/s]Creating MoE layer states:  14%|█▍        | 8/58 [00:01<00:11,  4.37it/s]Creating MoE layer states:  14%|█▍        | 8/58 [00:01<00:11,  4.32it/s]Creating MoE layer states:  16%|█▌        | 9/58 [00:02<00:11,  4.36it/s]Creating MoE layer states:  16%|█▌        | 9/58 [00:02<00:11,  4.31it/s]Creating MoE layer states:  17%|█▋        | 10/58 [00:02<00:11,  4.35it/s]Creating MoE layer states:  17%|█▋        | 10/58 [00:02<00:11,  4.32it/s]Creating MoE layer states:  19%|█▉        | 11/58 [00:02<00:10,  4.35it/s]Creating MoE layer states:  19%|█▉        | 11/58 [00:02<00:10,  4.32it/s]Creating MoE layer states:  21%|██        | 12/58 [00:02<00:10,  4.36it/s]Creating MoE layer states:  21%|██        | 12/58 [00:02<00:10,  4.32it/s]Creating MoE layer states:  22%|██▏       | 13/58 [00:02<00:10,  4.35it/s]Creating MoE layer states:  22%|██▏       | 13/58 [00:03<00:10,  4.31it/s]Creating MoE layer states:  24%|██▍       | 14/58 [00:03<00:10,  4.35it/s]Creating MoE layer states:  24%|██▍       | 14/58 [00:03<00:10,  4.31it/s]Creating MoE layer states:  26%|██▌       | 15/58 [00:03<00:09,  4.34it/s]Creating MoE layer states:  26%|██▌       | 15/58 [00:03<00:09,  4.30it/s]Creating MoE layer states:  28%|██▊       | 16/58 [00:03<00:09,  4.32it/s]Creating MoE layer states:  28%|██▊       | 16/58 [00:03<00:09,  4.31it/s]Creating MoE layer states:  29%|██▉       | 17/58 [00:03<00:09,  4.32it/s]Creating MoE layer states:  29%|██▉       | 17/58 [00:03<00:09,  4.31it/s]Creating MoE layer states:  31%|███       | 18/58 [00:04<00:09,  4.32it/s]Creating MoE layer states:  31%|███       | 18/58 [00:04<00:09,  4.31it/s]Creating MoE layer states:  33%|███▎      | 19/58 [00:04<00:09,  4.32it/s]Creating MoE layer states:  33%|███▎      | 19/58 [00:04<00:09,  4.31it/s]Creating MoE layer states:  34%|███▍      | 20/58 [00:04<00:08,  4.30it/s]Creating MoE layer states:  34%|███▍      | 20/58 [00:04<00:08,  4.28it/s]Creating MoE layer states:  36%|███▌      | 21/58 [00:04<00:08,  4.30it/s]Creating MoE layer states:  36%|███▌      | 21/58 [00:04<00:08,  4.29it/s]Creating MoE layer states:  38%|███▊      | 22/58 [00:05<00:08,  4.30it/s]Creating MoE layer states:  38%|███▊      | 22/58 [00:05<00:08,  4.29it/s]Creating MoE layer states:  40%|███▉      | 23/58 [00:05<00:08,  4.31it/s]Creating MoE layer states:  40%|███▉      | 23/58 [00:05<00:08,  4.30it/s]Creating MoE layer states:  41%|████▏     | 24/58 [00:05<00:07,  4.32it/s]Creating MoE layer states:  41%|████▏     | 24/58 [00:05<00:07,  4.31it/s]Creating MoE layer states:  43%|████▎     | 25/58 [00:05<00:07,  4.30it/s]Creating MoE layer states:  43%|████▎     | 25/58 [00:05<00:07,  4.31it/s]Creating MoE layer states:  45%|████▍     | 26/58 [00:05<00:07,  4.31it/s]Creating MoE layer states:  45%|████▍     | 26/58 [00:06<00:07,  4.31it/s]Creating MoE layer states:  47%|████▋     | 27/58 [00:06<00:07,  4.31it/s]Creating MoE layer states:  47%|████▋     | 27/58 [00:06<00:07,  4.30it/s]Creating MoE layer states:  48%|████▊     | 28/58 [00:06<00:06,  4.31it/s]Creating MoE layer states:  48%|████▊     | 28/58 [00:06<00:06,  4.29it/s]Creating MoE layer states:  50%|█████     | 29/58 [00:06<00:06,  4.31it/s]Creating MoE layer states:  50%|█████     | 29/58 [00:06<00:06,  4.28it/s]Creating MoE layer states:  52%|█████▏    | 30/58 [00:06<00:06,  4.32it/s]Creating MoE layer states:  52%|█████▏    | 30/58 [00:06<00:06,  4.27it/s]Creating MoE layer states:  53%|█████▎    | 31/58 [00:07<00:06,  4.32it/s]Creating MoE layer states:  53%|█████▎    | 31/58 [00:07<00:06,  4.27it/s]Creating MoE layer states:  55%|█████▌    | 32/58 [00:07<00:06,  4.31it/s]Creating MoE layer states:  55%|█████▌    | 32/58 [00:07<00:06,  4.27it/s]Creating MoE layer states:  57%|█████▋    | 33/58 [00:07<00:05,  4.30it/s]Creating MoE layer states:  57%|█████▋    | 33/58 [00:07<00:05,  4.26it/s]Creating MoE layer states:  59%|█████▊    | 34/58 [00:07<00:05,  4.30it/s]Creating MoE layer states:  59%|█████▊    | 34/58 [00:07<00:05,  4.26it/s]Creating MoE layer states:  60%|██████    | 35/58 [00:08<00:05,  4.31it/s]Creating MoE layer states:  60%|██████    | 35/58 [00:08<00:05,  4.27it/s]Creating MoE layer states:  62%|██████▏   | 36/58 [00:08<00:05,  4.31it/s]Creating MoE layer states:  62%|██████▏   | 36/58 [00:08<00:05,  4.28it/s]Creating MoE layer states:  64%|██████▍   | 37/58 [00:08<00:04,  4.29it/s]Creating MoE layer states:  64%|██████▍   | 37/58 [00:08<00:04,  4.29it/s]Creating MoE layer states:  66%|██████▌   | 38/58 [00:08<00:04,  4.29it/s]Creating MoE layer states:  66%|██████▌   | 38/58 [00:08<00:04,  4.29it/s]Creating MoE layer states:  67%|██████▋   | 39/58 [00:09<00:04,  4.30it/s]Creating MoE layer states:  67%|██████▋   | 39/58 [00:09<00:04,  4.30it/s]Creating MoE layer states:  69%|██████▉   | 40/58 [00:09<00:04,  4.29it/s]Creating MoE layer states:  69%|██████▉   | 40/58 [00:09<00:04,  4.27it/s]Creating MoE layer states:  71%|███████   | 41/58 [00:09<00:03,  4.29it/s]Creating MoE layer states:  71%|███████   | 41/58 [00:09<00:03,  4.28it/s]Creating MoE layer states:  72%|███████▏  | 42/58 [00:09<00:03,  4.29it/s]Creating MoE layer states:  72%|███████▏  | 42/58 [00:09<00:03,  4.29it/s]Creating MoE layer states:  74%|███████▍  | 43/58 [00:09<00:03,  4.28it/s]Creating MoE layer states:  74%|███████▍  | 43/58 [00:10<00:03,  4.29it/s]Creating MoE layer states:  76%|███████▌  | 44/58 [00:10<00:03,  4.28it/s]Creating MoE layer states:  76%|███████▌  | 44/58 [00:10<00:03,  4.28it/s]Creating MoE layer states:  78%|███████▊  | 45/58 [00:10<00:03,  4.26it/s]Creating MoE layer states:  78%|███████▊  | 45/58 [00:10<00:03,  4.29it/s]Creating MoE layer states:  79%|███████▉  | 46/58 [00:10<00:02,  4.26it/s]Creating MoE layer states:  79%|███████▉  | 46/58 [00:10<00:02,  4.21it/s]Creating MoE layer states:  81%|████████  | 47/58 [00:10<00:02,  4.25it/s]Creating MoE layer states:  81%|████████  | 47/58 [00:10<00:02,  4.24it/s]Creating MoE layer states:  83%|████████▎ | 48/58 [00:11<00:02,  4.25it/s]Creating MoE layer states:  83%|████████▎ | 48/58 [00:11<00:02,  4.26it/s]Creating MoE layer states:  84%|████████▍ | 49/58 [00:11<00:02,  4.21it/s]Creating MoE layer states:  84%|████████▍ | 49/58 [00:11<00:02,  4.27it/s]Creating MoE layer states:  86%|████████▌ | 50/58 [00:11<00:01,  4.22it/s]Creating MoE layer states:  86%|████████▌ | 50/58 [00:11<00:01,  4.28it/s]Creating MoE layer states:  88%|████████▊ | 51/58 [00:11<00:01,  4.23it/s]Creating MoE layer states:  88%|████████▊ | 51/58 [00:11<00:01,  4.29it/s]Creating MoE layer states:  90%|████████▉ | 52/58 [00:12<00:01,  4.24it/s]Creating MoE layer states:  90%|████████▉ | 52/58 [00:12<00:01,  4.29it/s]Creating MoE layer states:  91%|█████████▏| 53/58 [00:12<00:01,  4.24it/s]Creating MoE layer states:  91%|█████████▏| 53/58 [00:12<00:01,  4.29it/s]Creating MoE layer states:  93%|█████████▎| 54/58 [00:12<00:00,  4.23it/s]Creating MoE layer states:  93%|█████████▎| 54/58 [00:12<00:00,  4.30it/s]Creating MoE layer states:  95%|█████████▍| 55/58 [00:12<00:00,  4.25it/s]Creating MoE layer states:  95%|█████████▍| 55/58 [00:12<00:00,  4.30it/s]Creating MoE layer states:  97%|█████████▋| 56/58 [00:13<00:00,  4.26it/s]Creating MoE layer states:  97%|█████████▋| 56/58 [00:13<00:00,  4.30it/s]Creating MoE layer states:  98%|█████████▊| 57/58 [00:13<00:00,  4.23it/s]Creating MoE layer states:  98%|█████████▊| 57/58 [00:13<00:00,  4.31it/s]Creating MoE layer states: 100%|██████████| 58/58 [00:13<00:00,  4.24it/s]Creating MoE layer states: 100%|██████████| 58/58 [00:13<00:00,  4.30it/s]
[1,1]<stderr>: 2026-01-30 13:33:51.147 | INFO     | models.demos.deepseek_v3.tt.generator:_prepare_model_states:195 - Creating model shared states...
[1,0]<stderr>: Creating MoE layer states: 100%|██████████| 58/58 [00:13<00:00,  4.30it/s]Creating MoE layer states: 100%|██████████| 58/58 [00:13<00:00,  4.29it/s]
[1,0]<stderr>: 2026-01-30 13:33:51.175 | INFO     | models.demos.deepseek_v3.tt.generator:_prepare_model_states:195 - Creating model shared states...
[1,0]<stderr>: 2026-01-30 13:34:03.943 | INFO     | models.demos.deepseek_v3.tt.generator:_prepare_run_configs:235 - Model run config created for prefill...
[1,0]<stderr>: model_runner: Model initialized successfully
[1,0]<stderr>: model_runner: Model KV cache managed internally by DeepseekGenerator
[1,0]<stderr>: prefill_node_poc.timing:   [ model_runner.allocate_kv_cache ]  latency_ms=27577.458
[1,0]<stderr>: scheduler: kv_cache memory calc available_gb=12.00 num_layers=61 -> num_blocks=11459
[1,0]<stderr>: prefill_engine: engine init max_num_seqs=4 max_num_batched_tokens=8192 num_kvcache_blocks=11459
[1,0]<stderr>: root: Adding prompts to engine...
[1,0]<stderr>: scheduler: request added req_id=req_0 prompt_len=10 waiting=1
[1,0]<stderr>: prefill_engine: add_request req_id=req_0 prompt_len=10
[1,0]<stderr>: root: Added: req_0 - 10 tokens - 'What is the capital of France?...'
[1,0]<stderr>: root: Running prefills...
[1,0]<stderr>: block_manager: allocated blocks req_id=req_0 num_blocks=1 block_ids=[0] free_after=11458
[1,0]<stderr>: scheduler: scheduled batch num_seqs=1 num_batched_tokens=10 req_ids=['req_0'] waiting_left=0
[1,0]<stderr>: prefill_node_poc.timing:   [ scheduler.schedule ]  latency_ms=0.047
[1,0]<stderr>: model_runner: run_prefill start num_seqs=1 req_ids=['req_0']
[1,0]<stderr>: model_runner: Running prefill for req_id=req_0 user_id=0 prompt_len=10
[1,1]<stderr>: 2026-01-30 13:34:17.489 | INFO     | models.demos.deepseek_v3.tt.generator:_prepare_run_configs:235 - Model run config created for prefill...
[1,1]<stderr>: model_runner: Model initialized successfully
[1,1]<stderr>: model_runner: Model KV cache managed internally by DeepseekGenerator
[1,1]<stderr>: prefill_node_poc.timing:   [ model_runner.allocate_kv_cache ]  latency_ms=46060.497
[1,1]<stderr>: scheduler: kv_cache memory calc available_gb=12.00 num_layers=61 -> num_blocks=11459
[1,1]<stderr>: prefill_engine: engine init max_num_seqs=4 max_num_batched_tokens=8192 num_kvcache_blocks=11459
[1,1]<stderr>: root: Adding prompts to engine...
[1,1]<stderr>: scheduler: request added req_id=req_0 prompt_len=10 waiting=1
[1,1]<stderr>: prefill_engine: add_request req_id=req_0 prompt_len=10
[1,1]<stderr>: root: Added: req_0 - 10 tokens - 'What is the capital of France?...'
[1,1]<stderr>: root: Running prefills...
[1,1]<stderr>: block_manager: allocated blocks req_id=req_0 num_blocks=1 block_ids=[0] free_after=11458
[1,1]<stderr>: scheduler: scheduled batch num_seqs=1 num_batched_tokens=10 req_ids=['req_0'] waiting_left=0
[1,1]<stderr>: prefill_node_poc.timing:   [ scheduler.schedule ]  latency_ms=0.046
[1,1]<stderr>: model_runner: run_prefill start num_seqs=1 req_ids=['req_0']
[1,1]<stderr>: model_runner: Running prefill for req_id=req_0 user_id=0 prompt_len=10
[1,1]<stderr>: model_runner: run_prefill done logits_shape=(1, 32, 129280)
[1,1]<stderr>: prefill_node_poc.timing:   [ model_runner.run_prefill ]  latency_ms=18735.867
[1,1]<stderr>: prefill_engine: step done num_seqs=1 logits_shape=(1, 32, 129280) req_ids=['req_0']
[1,1]<stderr>: prefill_node_poc.timing:   [ prefill_engine.step ]  latency_ms=18735.981
[1,0]<stderr>: model_runner: run_prefill done logits_shape=(1, 32, 129280)
[1,0]<stderr>: prefill_node_poc.timing:   [ model_runner.run_prefill ]  latency_ms=32282.925
[1,0]<stderr>: prefill_engine: step done num_seqs=1 logits_shape=(1, 32, 129280) req_ids=['req_0']
[1,1]<stderr>: root: Prefill complete: req_id=req_0 prompt_len=10 first_token=128798 '<think>'
[1,0]<stderr>: prefill_node_poc.timing:   [ prefill_engine.step ]  latency_ms=32283.040
[1,1]<stderr>: prefill_engine: release_after_prefill num_seqs=1 req_ids=['req_0']
[1,1]<stderr>: scheduler: releasing seqs num=1 req_ids=['req_0']
[1,1]<stderr>: block_manager: deallocated blocks req_id=req_0 num_blocks=1 free_after=11459
[1,1]<stderr>: prefill_node_poc.timing:   [ scheduler.release ]  latency_ms=0.039
[1,1]<stderr>: prefill_node_poc.timing:   [ prefill_engine.release_after_prefill ]  latency_ms=0.072
[1,1]<stderr>: root: Cleaning up...
[1,0]<stderr>: root: Prefill complete: req_id=req_0 prompt_len=10 first_token=128798 '<think>'
[1,0]<stderr>: prefill_engine: release_after_prefill num_seqs=1 req_ids=['req_0']
[1,0]<stderr>: scheduler: releasing seqs num=1 req_ids=['req_0']
[1,0]<stderr>: block_manager: deallocated blocks req_id=req_0 num_blocks=1 free_after=11459
[1,0]<stderr>: prefill_node_poc.timing:   [ scheduler.release ]  latency_ms=0.039
[1,0]<stderr>: prefill_node_poc.timing:   [ prefill_engine.release_after_prefill ]  latency_ms=0.074
[1,0]<stderr>: root: Cleaning up...
[1,1]<stderr>: 2026-01-30 13:34:36.267 | INFO     | models.demos.deepseek_v3.tt.generator:_cleanup_run_configs:247 - No decode run config to cleanup
[1,0]<stderr>: 2026-01-30 13:34:36.270 | INFO     | models.demos.deepseek_v3.tt.generator:_cleanup_run_configs:247 - No decode run config to cleanup
[1,1]<stderr>: model_runner: model_runner cleanup
[1,1]<stderr>: prefill_engine: engine cleanup
[1,0]<stderr>: model_runner: model_runner cleanup
[1,0]<stderr>: prefill_engine: engine cleanup
