2026-01-30 13:55:36.399 | DEBUG    | ttnn:<module>:77 - Initial ttnn.CONFIG:
Config{cache_path=/home/dmadic/.cache/ttnn,model_cache_path=/home/dmadic/.cache/ttnn/models,tmp_dir=/tmp/ttnn,enable_model_cache=false,enable_fast_runtime_mode=true,throw_exception_on_fallback=false,enable_logging=false,enable_graph_report=false,enable_detailed_buffer_report=false,enable_detailed_tensor_report=false,enable_comparison_mode=false,comparison_mode_should_raise_exception=false,comparison_mode_pcc=0.9999,root_report_path=generated/ttnn/reports,report_name=std::nullopt,std::nullopt}
2026-01-30 13:55:38.289 | INFO     | ttnn.distributed.ttrun:print_command:231 - [tt-run] Command:
2026-01-30 13:55:38.289 | INFO     | ttnn.distributed.ttrun:print_command:245 - [tt-run] Command: mpirun --hostfile /tmp/993_hosts.txt --map-by ppr:1:node --mca btl self,tcp --mca btl_tcp_if_exclude docker0,lo --bind-to none --tag-output -np 1 -x TT_METAL_CACHE=/home/dmadic/.cache_wh-glx-a05u02_rank0 -x TT_MESH_ID=0 -x TT_MESH_GRAPH_DESC_PATH=/data/dmadic/tt-metal/tt_metal/fabric/mesh_graph_descriptors/dual_galaxy_mesh_graph_descriptor.textproto -x TT_METAL_HOME=/data/dmadic/tt-metal -x TT_METAL_RUNTIME_ROOT=/data/dmadic/tt-metal -x PYTHONPATH=/data/dmadic/tt-metal:/data/dmadic/tt-inference-server/prefill-node-poc: -x LD_LIBRARY_PATH=/home/dmadic/build/lib -x TT_MESH_HOST_RANK=0 python /data/dmadic/tt-inference-server/prefill-node-poc/main_prefill_real.py --model-path /mnt/models/deepseek-ai/DeepSeek-R1-0528 --cache-dir /data/dmadic/deepseek-ai/DeepSeek-R1-0528-Cache What is the capital of France? : -np 1 -x TT_METAL_CACHE=/home/dmadic/.cache_wh-glx-a05u02_rank1 -x TT_MESH_ID=0 -x TT_MESH_GRAPH_DESC_PATH=/data/dmadic/tt-metal/tt_metal/fabric/mesh_graph_descriptors/dual_galaxy_mesh_graph_descriptor.textproto -x TT_METAL_HOME=/data/dmadic/tt-metal -x TT_METAL_RUNTIME_ROOT=/data/dmadic/tt-metal -x PYTHONPATH=/data/dmadic/tt-metal:/data/dmadic/tt-inference-server/prefill-node-poc: -x LD_LIBRARY_PATH=/home/dmadic/build/lib -x TT_MESH_HOST_RANK=1 python /data/dmadic/tt-inference-server/prefill-node-poc/main_prefill_real.py --model-path /mnt/models/deepseek-ai/DeepSeek-R1-0528 --cache-dir /data/dmadic/deepseek-ai/DeepSeek-R1-0528-Cache What is the capital of France?
[1,0]<stderr>: 2026-01-30 13:55:40.868 | DEBUG    | ttnn:<module>:77 - Initial ttnn.CONFIG:
[1,0]<stderr>: Config{cache_path=/home/dmadic/.cache/ttnn,model_cache_path=/home/dmadic/.cache/ttnn/models,tmp_dir=/tmp/ttnn,enable_model_cache=false,enable_fast_runtime_mode=true,throw_exception_on_fallback=false,enable_logging=false,enable_graph_report=false,enable_detailed_buffer_report=false,enable_detailed_tensor_report=false,enable_comparison_mode=false,comparison_mode_should_raise_exception=false,comparison_mode_pcc=0.9999,root_report_path=generated/ttnn/reports,report_name=std::nullopt,std::nullopt}
[1,1]<stderr>: 2026-01-30 13:55:42.389 | DEBUG    | ttnn:<module>:77 - Initial ttnn.CONFIG:
[1,1]<stderr>: Config{cache_path=/home/dmadic/.cache/ttnn,model_cache_path=/home/dmadic/.cache/ttnn/models,tmp_dir=/tmp/ttnn,enable_model_cache=false,enable_fast_runtime_mode=true,throw_exception_on_fallback=false,enable_logging=false,enable_graph_report=false,enable_detailed_buffer_report=false,enable_detailed_tensor_report=false,enable_comparison_mode=false,comparison_mode_should_raise_exception=false,comparison_mode_pcc=0.9999,root_report_path=generated/ttnn/reports,report_name=std::nullopt,std::nullopt}
[1,0]<stderr>: root: MESH_DEVICE: 'DUAL' - mesh shape: MeshShape([8, 8])
[1,1]<stderr>: root: MESH_DEVICE: 'DUAL' - mesh shape: MeshShape([8, 8])
[1,0]<stderr>: root: Opening mesh device with shape MeshShape([8, 8])
[1,1]<stderr>: root: Opening mesh device with shape MeshShape([8, 8])
[1,1]<stderr>: 2026-01-30 13:55:47.708 | DEBUG    | ttnn.device:__init__:150 - Using default dispatch core type for this system: DispatchCoreType.WORKER
[1,1]<stderr>: 2026-01-30 13:55:47.708 | DEBUG    | ttnn.device:__init__:152 - Using default dispatch core axis for this system: DispatchCoreAxis.ROW
[1,0]<stderr>: 2026-01-30 13:55:47.708 | DEBUG    | ttnn.device:__init__:150 - Using default dispatch core type for this system: DispatchCoreType.WORKER
[1,0]<stderr>: 2026-01-30 13:55:47.709 | DEBUG    | ttnn.device:__init__:152 - Using default dispatch core axis for this system: DispatchCoreAxis.ROW
[1,1]<stderr>: root: KvCacheConfig: shape=(2048, 1, 32, 576) dtype=bfloat8_b
[1,1]<stderr>: root: Creating PrefillEngine...
[1,1]<stderr>: scheduler: kv_cache memory calc available_gb=12.00 num_layers=61 -> num_blocks=11459
[1,1]<stderr>: scheduler: block_manager num_blocks=11459 (from memory calc)
[1,1]<stderr>: 2026-01-30 13:55:58.565 | WARNING  | models.perf.benchmarking_utils:<module>:18 - Skipping import of pydantic_models for benchmarking since not running in CI environment
[1,1]<stderr>: model_runner: ============================================================
[1,1]<stderr>: model_runner: INITIALIZING DEEPSEEK GENERATOR
[1,1]<stderr>: model_runner: ============================================================
[1,1]<stderr>: model_runner: ModelConfig: model_path=/mnt/models/deepseek-ai/DeepSeek-R1-0528 cache_dir=/data/dmadic/deepseek-ai/DeepSeek-R1-0528-Cache
[1,0]<stderr>: root: KvCacheConfig: shape=(2048, 1, 32, 576) dtype=bfloat8_b
[1,0]<stderr>: root: Creating PrefillEngine...
[1,0]<stderr>: scheduler: kv_cache memory calc available_gb=12.00 num_layers=61 -> num_blocks=11459
[1,0]<stderr>: scheduler: block_manager num_blocks=11459 (from memory calc)
[1,0]<stderr>: 2026-01-30 13:55:58.630 | WARNING  | models.perf.benchmarking_utils:<module>:18 - Skipping import of pydantic_models for benchmarking since not running in CI environment
[1,0]<stderr>: model_runner: ============================================================
[1,0]<stderr>: model_runner: INITIALIZING DEEPSEEK GENERATOR
[1,0]<stderr>: model_runner: ============================================================
[1,0]<stderr>: model_runner: ModelConfig: model_path=/mnt/models/deepseek-ai/DeepSeek-R1-0528 cache_dir=/data/dmadic/deepseek-ai/DeepSeek-R1-0528-Cache
[1,1]<stderr>: model_runner: Tokenizer: vocab_size=128000 pad_token_id=1
[1,0]<stderr>: model_runner: Tokenizer: vocab_size=128000 pad_token_id=1
[1,0]<stderr>: 2026-01-30 13:55:58.935 | INFO     | models.demos.deepseek_v3.tt.generator:__init__:144 - Enable trace: False
[1,1]<stderr>: 2026-01-30 13:55:58.935 | INFO     | models.demos.deepseek_v3.tt.generator:__init__:144 - Enable trace: False
[1,0]<stderr>: 2026-01-30 13:55:59.190 | INFO     | models.demos.deepseek_v3.utils.weight_config:_try_load_cached_config:104 - Using weights cached at /data/dmadic/deepseek-ai/DeepSeek-R1-0528-Cache/61_layers/mesh_8x8
[1,1]<stderr>: 2026-01-30 13:55:59.194 | INFO     | models.demos.deepseek_v3.utils.weight_config:_try_load_cached_config:104 - Using weights cached at /data/dmadic/deepseek-ai/DeepSeek-R1-0528-Cache/61_layers/mesh_8x8
[1,0]<stderr>: model_runner: Generator: batch_size=256 num_layers=61
[1,0]<stderr>: model_runner: ============================================================
[1,0]<stderr>: model_runner: ============================================================
[1,0]<stderr>: model_runner: ALLOCATING KV CACHE
[1,0]<stderr>: model_runner:   shape: (2048, 1, 32, 576) dtype: bfloat8_b
[1,0]<stderr>: 2026-01-30 13:55:59.196 | INFO     | models.demos.deepseek_v3.tt.generator:_prepare_run_configs:202 - Creating model prefill config...
[1,0]<stderr>: 2026-01-30 13:55:59.196 | INFO     | models.demos.deepseek_v3.tt.generator:_prepare_model_states:187 - Creating model states...
[1,1]<stderr>: Creating MLP layer states:   0%|          | 0/3 [00:00<?, ?it/s]model_runner: Generator: batch_size=256 num_layers=61
[1,1]<stderr>: model_runner: ============================================================
[1,1]<stderr>: model_runner: ============================================================
[1,1]<stderr>: model_runner: ALLOCATING KV CACHE
[1,1]<stderr>: model_runner:   shape: (2048, 1, 32, 576) dtype: bfloat8_b
[1,1]<stderr>: 2026-01-30 13:55:59.200 | INFO     | models.demos.deepseek_v3.tt.generator:_prepare_run_configs:202 - Creating model prefill config...
[1,1]<stderr>: 2026-01-30 13:55:59.200 | INFO     | models.demos.deepseek_v3.tt.generator:_prepare_model_states:187 - Creating model states...
[1,1]<stderr>: Creating MLP layer states:   0%|          | 0/3 [00:00<?, ?it/s]Creating MLP layer states:  33%|███▎      | 1/3 [00:00<00:00,  2.10it/s]Creating MLP layer states:  33%|███▎      | 1/3 [00:00<00:00,  2.11it/s]Creating MLP layer states:  67%|██████▋   | 2/3 [00:00<00:00,  2.11it/s]Creating MLP layer states:  67%|██████▋   | 2/3 [00:00<00:00,  2.11it/s]Creating MLP layer states: 100%|██████████| 3/3 [00:01<00:00,  2.13it/s]Creating MLP layer states: 100%|██████████| 3/3 [00:01<00:00,  2.12it/s]
[1,0]<stderr>: Creating MoE layer states:   0%|          | 0/58 [00:00<?, ?it/s]Creating MLP layer states: 100%|██████████| 3/3 [00:01<00:00,  2.12it/s]Creating MLP layer states: 100%|██████████| 3/3 [00:01<00:00,  2.12it/s]
[1,0]<stderr>: Creating MoE layer states:   0%|          | 0/58 [00:00<?, ?it/s]Creating MoE layer states:   2%|▏         | 1/58 [00:00<00:26,  2.14it/s]Creating MoE layer states:   2%|▏         | 1/58 [00:00<00:26,  2.13it/s]Creating MoE layer states:   3%|▎         | 2/58 [00:00<00:26,  2.14it/s]Creating MoE layer states:   3%|▎         | 2/58 [00:00<00:26,  2.11it/s]Creating MoE layer states:   5%|▌         | 3/58 [00:01<00:25,  2.12it/s]Creating MoE layer states:   5%|▌         | 3/58 [00:01<00:25,  2.12it/s]Creating MoE layer states:   7%|▋         | 4/58 [00:01<00:25,  2.13it/s]Creating MoE layer states:   7%|▋         | 4/58 [00:01<00:25,  2.12it/s]Creating MoE layer states:   9%|▊         | 5/58 [00:02<00:24,  2.12it/s]Creating MoE layer states:   9%|▊         | 5/58 [00:02<00:25,  2.12it/s]Creating MoE layer states:  10%|█         | 6/58 [00:02<00:24,  2.12it/s]Creating MoE layer states:  10%|█         | 6/58 [00:02<00:24,  2.12it/s]Creating MoE layer states:  12%|█▏        | 7/58 [00:03<00:24,  2.12it/s]Creating MoE layer states:  12%|█▏        | 7/58 [00:03<00:24,  2.12it/s]Creating MoE layer states:  14%|█▍        | 8/58 [00:03<00:23,  2.12it/s]Creating MoE layer states:  14%|█▍        | 8/58 [00:03<00:23,  2.12it/s]Creating MoE layer states:  16%|█▌        | 9/58 [00:04<00:23,  2.12it/s]Creating MoE layer states:  16%|█▌        | 9/58 [00:04<00:23,  2.12it/s]Creating MoE layer states:  17%|█▋        | 10/58 [00:04<00:22,  2.12it/s]Creating MoE layer states:  17%|█▋        | 10/58 [00:04<00:22,  2.11it/s]Creating MoE layer states:  19%|█▉        | 11/58 [00:05<00:22,  2.13it/s]Creating MoE layer states:  19%|█▉        | 11/58 [00:05<00:22,  2.12it/s]Creating MoE layer states:  21%|██        | 12/58 [00:05<00:21,  2.13it/s]Creating MoE layer states:  21%|██        | 12/58 [00:05<00:21,  2.11it/s]Creating MoE layer states:  22%|██▏       | 13/58 [00:06<00:21,  2.13it/s]Creating MoE layer states:  22%|██▏       | 13/58 [00:06<00:21,  2.11it/s]Creating MoE layer states:  24%|██▍       | 14/58 [00:06<00:20,  2.12it/s]Creating MoE layer states:  24%|██▍       | 14/58 [00:06<00:20,  2.11it/s]Creating MoE layer states:  26%|██▌       | 15/58 [00:07<00:20,  2.13it/s]Creating MoE layer states:  26%|██▌       | 15/58 [00:07<00:20,  2.11it/s]Creating MoE layer states:  28%|██▊       | 16/58 [00:07<00:19,  2.13it/s]Creating MoE layer states:  28%|██▊       | 16/58 [00:07<00:21,  1.95it/s]Creating MoE layer states:  29%|██▉       | 17/58 [00:08<00:19,  2.13it/s]Creating MoE layer states:  29%|██▉       | 17/58 [00:08<00:20,  2.00it/s]Creating MoE layer states:  31%|███       | 18/58 [00:08<00:18,  2.13it/s]Creating MoE layer states:  31%|███       | 18/58 [00:08<00:19,  2.03it/s]Creating MoE layer states:  33%|███▎      | 19/58 [00:08<00:18,  2.13it/s]Creating MoE layer states:  33%|███▎      | 19/58 [00:09<00:18,  2.06it/s]Creating MoE layer states:  34%|███▍      | 20/58 [00:09<00:17,  2.12it/s]Creating MoE layer states:  34%|███▍      | 20/58 [00:09<00:18,  2.08it/s]Creating MoE layer states:  36%|███▌      | 21/58 [00:09<00:17,  2.12it/s]Creating MoE layer states:  36%|███▌      | 21/58 [00:10<00:17,  2.09it/s]Creating MoE layer states:  38%|███▊      | 22/58 [00:10<00:17,  2.04it/s]Creating MoE layer states:  38%|███▊      | 22/58 [00:10<00:17,  2.10it/s]Creating MoE layer states:  40%|███▉      | 23/58 [00:10<00:16,  2.06it/s]Creating MoE layer states:  40%|███▉      | 23/58 [00:10<00:16,  2.11it/s]Creating MoE layer states:  41%|████▏     | 24/58 [00:11<00:16,  2.07it/s]Creating MoE layer states:  41%|████▏     | 24/58 [00:11<00:16,  2.11it/s]Creating MoE layer states:  43%|████▎     | 25/58 [00:11<00:15,  2.08it/s]Creating MoE layer states:  43%|████▎     | 25/58 [00:11<00:15,  2.11it/s]Creating MoE layer states:  45%|████▍     | 26/58 [00:12<00:15,  2.09it/s]Creating MoE layer states:  45%|████▍     | 26/58 [00:12<00:15,  2.11it/s]Creating MoE layer states:  47%|████▋     | 27/58 [00:12<00:14,  2.09it/s]Creating MoE layer states:  47%|████▋     | 27/58 [00:12<00:14,  2.12it/s]Creating MoE layer states:  48%|████▊     | 28/58 [00:13<00:14,  2.10it/s]Creating MoE layer states:  48%|████▊     | 28/58 [00:13<00:14,  2.10it/s]Creating MoE layer states:  50%|█████     | 29/58 [00:13<00:13,  2.10it/s]Creating MoE layer states:  50%|█████     | 29/58 [00:13<00:13,  2.10it/s]Creating MoE layer states:  52%|█████▏    | 30/58 [00:14<00:13,  2.10it/s]Creating MoE layer states:  52%|█████▏    | 30/58 [00:14<00:13,  2.11it/s]Creating MoE layer states:  53%|█████▎    | 31/58 [00:14<00:12,  2.10it/s]Creating MoE layer states:  53%|█████▎    | 31/58 [00:14<00:12,  2.11it/s]Creating MoE layer states:  55%|█████▌    | 32/58 [00:15<00:12,  2.10it/s]Creating MoE layer states:  55%|█████▌    | 32/58 [00:15<00:12,  2.11it/s]Creating MoE layer states:  57%|█████▋    | 33/58 [00:15<00:11,  2.10it/s]Creating MoE layer states:  57%|█████▋    | 33/58 [00:15<00:11,  2.11it/s]Creating MoE layer states:  59%|█████▊    | 34/58 [00:16<00:11,  2.10it/s]Creating MoE layer states:  59%|█████▊    | 34/58 [00:16<00:11,  2.11it/s]Creating MoE layer states:  60%|██████    | 35/58 [00:16<00:11,  2.09it/s]Creating MoE layer states:  60%|██████    | 35/58 [00:16<00:10,  2.11it/s]Creating MoE layer states:  62%|██████▏   | 36/58 [00:17<00:10,  2.09it/s]Creating MoE layer states:  62%|██████▏   | 36/58 [00:17<00:10,  2.11it/s]Creating MoE layer states:  64%|██████▍   | 37/58 [00:17<00:09,  2.10it/s]Creating MoE layer states:  64%|██████▍   | 37/58 [00:17<00:09,  2.11it/s]Creating MoE layer states:  66%|██████▌   | 38/58 [00:18<00:09,  2.10it/s]Creating MoE layer states:  66%|██████▌   | 38/58 [00:18<00:09,  2.11it/s]Creating MoE layer states:  67%|██████▋   | 39/58 [00:18<00:09,  2.10it/s]Creating MoE layer states:  67%|██████▋   | 39/58 [00:18<00:09,  2.11it/s]Creating MoE layer states:  69%|██████▉   | 40/58 [00:18<00:08,  2.10it/s]Creating MoE layer states:  69%|██████▉   | 40/58 [00:19<00:08,  2.11it/s]Creating MoE layer states:  71%|███████   | 41/58 [00:19<00:08,  2.10it/s]Creating MoE layer states:  71%|███████   | 41/58 [00:19<00:08,  2.11it/s]Creating MoE layer states:  72%|███████▏  | 42/58 [00:19<00:07,  2.10it/s]Creating MoE layer states:  72%|███████▏  | 42/58 [00:19<00:07,  2.11it/s]Creating MoE layer states:  74%|███████▍  | 43/58 [00:20<00:07,  2.10it/s]Creating MoE layer states:  74%|███████▍  | 43/58 [00:20<00:07,  2.11it/s]Creating MoE layer states:  76%|███████▌  | 44/58 [00:20<00:06,  2.11it/s]Creating MoE layer states:  76%|███████▌  | 44/58 [00:20<00:06,  2.11it/s]Creating MoE layer states:  78%|███████▊  | 45/58 [00:21<00:06,  2.11it/s]Creating MoE layer states:  78%|███████▊  | 45/58 [00:21<00:06,  2.11it/s]Creating MoE layer states:  79%|███████▉  | 46/58 [00:21<00:05,  2.11it/s]Creating MoE layer states:  79%|███████▉  | 46/58 [00:21<00:05,  2.11it/s]Creating MoE layer states:  81%|████████  | 47/58 [00:22<00:05,  2.11it/s]Creating MoE layer states:  81%|████████  | 47/58 [00:22<00:05,  2.11it/s]Creating MoE layer states:  83%|████████▎ | 48/58 [00:22<00:04,  2.11it/s]Creating MoE layer states:  83%|████████▎ | 48/58 [00:22<00:04,  2.11it/s]Creating MoE layer states:  84%|████████▍ | 49/58 [00:23<00:04,  2.11it/s]Creating MoE layer states:  84%|████████▍ | 49/58 [00:23<00:04,  2.11it/s]Creating MoE layer states:  86%|████████▌ | 50/58 [00:23<00:03,  2.09it/s]Creating MoE layer states:  86%|████████▌ | 50/58 [00:23<00:03,  2.11it/s]Creating MoE layer states:  88%|████████▊ | 51/58 [00:24<00:03,  2.09it/s]Creating MoE layer states:  88%|████████▊ | 51/58 [00:24<00:03,  2.11it/s]Creating MoE layer states:  90%|████████▉ | 52/58 [00:24<00:02,  2.09it/s]Creating MoE layer states:  90%|████████▉ | 52/58 [00:24<00:02,  2.11it/s]Creating MoE layer states:  91%|█████████▏| 53/58 [00:25<00:02,  2.10it/s]Creating MoE layer states:  91%|█████████▏| 53/58 [00:25<00:02,  2.11it/s]Creating MoE layer states:  93%|█████████▎| 54/58 [00:25<00:01,  2.10it/s]Creating MoE layer states:  93%|█████████▎| 54/58 [00:25<00:01,  2.11it/s]Creating MoE layer states:  95%|█████████▍| 55/58 [00:26<00:01,  2.10it/s]Creating MoE layer states:  95%|█████████▍| 55/58 [00:26<00:01,  2.09it/s]Creating MoE layer states:  97%|█████████▋| 56/58 [00:26<00:00,  2.10it/s]Creating MoE layer states:  97%|█████████▋| 56/58 [00:26<00:00,  2.10it/s]Creating MoE layer states:  98%|█████████▊| 57/58 [00:27<00:00,  2.10it/s]Creating MoE layer states:  98%|█████████▊| 57/58 [00:27<00:00,  2.11it/s]Creating MoE layer states: 100%|██████████| 58/58 [00:27<00:00,  2.10it/s]Creating MoE layer states: 100%|██████████| 58/58 [00:27<00:00,  2.10it/s]
[1,0]<stderr>: 2026-01-30 13:56:28.170 | INFO     | models.demos.deepseek_v3.tt.generator:_prepare_model_states:195 - Creating model shared states...
[1,1]<stderr>: Creating MoE layer states: 100%|██████████| 58/58 [00:27<00:00,  2.11it/s]Creating MoE layer states: 100%|██████████| 58/58 [00:27<00:00,  2.10it/s]
[1,1]<stderr>: 2026-01-30 13:56:28.188 | INFO     | models.demos.deepseek_v3.tt.generator:_prepare_model_states:195 - Creating model shared states...
[1,0]<stderr>: 2026-01-30 13:56:40.548 | INFO     | models.demos.deepseek_v3.tt.generator:_prepare_run_configs:235 - Model run config created for prefill...
[1,0]<stderr>: model_runner:   num_layers: 61
[1,0]<stderr>: model_runner:   per_layer_shape: Shape([2048, 1, 32, 576])
[1,0]<stderr>: model_runner: ============================================================
[1,0]<stderr>: prefill_node_poc.timing:   [ model_runner.allocate_kv_cache ]  latency_ms=41938.296
[1,0]<stderr>: scheduler: kv_cache memory calc available_gb=12.00 num_layers=61 -> num_blocks=11459
[1,0]<stderr>: prefill_engine: engine init max_num_seqs=4 max_num_batched_tokens=8192 num_kvcache_blocks=11459
[1,0]<stderr>: root: Adding prompts...
[1,0]<stderr>: scheduler: request added req_id=req_0 prompt_len=10 waiting=1
[1,0]<stderr>: prefill_engine: add_request req_id=req_0 prompt_len=10
[1,0]<stderr>: root: Added: req_0 - 10 tokens
[1,0]<stderr>: root: Running prefills...
[1,0]<stderr>: block_manager: allocated blocks req_id=req_0 num_blocks=1 block_ids=[0] free_after=11458
[1,0]<stderr>: scheduler: scheduled batch num_seqs=1 num_batched_tokens=10 req_ids=['req_0'] waiting_left=0
[1,0]<stderr>: prefill_node_poc.timing:   [ scheduler.schedule ]  latency_ms=0.048
[1,0]<stderr>: model_runner: ============================================================
[1,0]<stderr>: model_runner: RUN_PREFILL: num_seqs=1 req_ids=['req_0']
[1,0]<stderr>: model_runner:   user=0 prompt_len=10 padded_len=32
[1,1]<stderr>: 2026-01-30 13:56:42.956 | INFO     | models.demos.deepseek_v3.tt.generator:_prepare_run_configs:235 - Model run config created for prefill...
[1,1]<stderr>: model_runner:   num_layers: 61
[1,1]<stderr>: model_runner:   per_layer_shape: Shape([2048, 1, 32, 576])
[1,1]<stderr>: model_runner: ============================================================
[1,1]<stderr>: prefill_node_poc.timing:   [ model_runner.allocate_kv_cache ]  latency_ms=44410.938
[1,1]<stderr>: scheduler: kv_cache memory calc available_gb=12.00 num_layers=61 -> num_blocks=11459
[1,1]<stderr>: prefill_engine: engine init max_num_seqs=4 max_num_batched_tokens=8192 num_kvcache_blocks=11459
[1,1]<stderr>: root: Adding prompts...
[1,1]<stderr>: scheduler: request added req_id=req_0 prompt_len=10 waiting=1
[1,1]<stderr>: prefill_engine: add_request req_id=req_0 prompt_len=10
[1,1]<stderr>: root: Added: req_0 - 10 tokens
[1,1]<stderr>: root: Running prefills...
[1,1]<stderr>: block_manager: allocated blocks req_id=req_0 num_blocks=1 block_ids=[0] free_after=11458
[1,1]<stderr>: scheduler: scheduled batch num_seqs=1 num_batched_tokens=10 req_ids=['req_0'] waiting_left=0
[1,1]<stderr>: prefill_node_poc.timing:   [ scheduler.schedule ]  latency_ms=0.051
[1,1]<stderr>: model_runner: ============================================================
[1,1]<stderr>: model_runner: RUN_PREFILL: num_seqs=1 req_ids=['req_0']
[1,1]<stderr>: model_runner:   user=0 prompt_len=10 padded_len=32
[1,1]<stderr>: model_runner: RUN_PREFILL COMPLETE: logits_shape=(1, 32, 129280)
[1,1]<stderr>: model_runner: ============================================================
[1,1]<stderr>: prefill_node_poc.timing:   [ model_runner.run_prefill ]  latency_ms=86961.617
[1,1]<stderr>: prefill_engine: step done num_seqs=1 logits_shape=(1, 32, 129280) req_ids=['req_0']
[1,1]<stderr>: prefill_node_poc.timing:   [ prefill_engine.step ]  latency_ms=86961.730
[1,0]<stderr>: model_runner: RUN_PREFILL COMPLETE: logits_shape=(1, 32, 129280)
[1,0]<stderr>: model_runner: ============================================================
[1,0]<stderr>: prefill_node_poc.timing:   [ model_runner.run_prefill ]  latency_ms=89370.470
[1,0]<stderr>: prefill_engine: step done num_seqs=1 logits_shape=(1, 32, 129280) req_ids=['req_0']
[1,0]<stderr>: prefill_node_poc.timing:   [ prefill_engine.step ]  latency_ms=89370.580
[1,1]<stderr>: root: Prefill: req_id=req_0 first_token=128798 '<think>'
[1,1]<stderr>: prefill_engine: release_after_prefill num_seqs=1 req_ids=['req_0']
[1,1]<stderr>: scheduler: releasing seqs num=1 req_ids=['req_0']
[1,1]<stderr>: block_manager: deallocated blocks req_id=req_0 num_blocks=1 free_after=11459
[1,1]<stderr>: prefill_node_poc.timing:   [ scheduler.release ]  latency_ms=0.040
[1,1]<stderr>: prefill_node_poc.timing:   [ prefill_engine.release_after_prefill ]  latency_ms=0.076
[1,1]<stderr>: root: Cleaning up...
[1,0]<stderr>: root: Prefill: req_id=req_0 first_token=128798 '<think>'
[1,0]<stderr>: prefill_engine: release_after_prefill num_seqs=1 req_ids=['req_0']
[1,0]<stderr>: scheduler: releasing seqs num=1 req_ids=['req_0']
[1,0]<stderr>: block_manager: deallocated blocks req_id=req_0 num_blocks=1 free_after=11459
[1,0]<stderr>: prefill_node_poc.timing:   [ scheduler.release ]  latency_ms=0.039
[1,0]<stderr>: prefill_node_poc.timing:   [ prefill_engine.release_after_prefill ]  latency_ms=0.075
[1,0]<stderr>: root: Cleaning up...
[1,1]<stderr>: 2026-01-30 13:58:09.959 | INFO     | models.demos.deepseek_v3.tt.generator:_cleanup_run_configs:247 - No decode run config to cleanup
[1,0]<stderr>: 2026-01-30 13:58:09.959 | INFO     | models.demos.deepseek_v3.tt.generator:_cleanup_run_configs:247 - No decode run config to cleanup
[1,1]<stderr>: model_runner: model_runner cleanup
[1,1]<stderr>: prefill_engine: engine cleanup
[1,0]<stderr>: model_runner: model_runner cleanup
[1,0]<stderr>: prefill_engine: engine cleanup
